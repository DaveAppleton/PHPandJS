<!DOCTYPE html>
<html>
    <head>
        <title>Listing Editor</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    </head>
    <style>
        #t2co_table {
            font-family: Arial, Helvetica, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }

        #t2co_table td, #t2co_table th {
            border: 1px solid #ddd;
            padding: 8px;
        }

        #t2co_table tr:nth-child(even){background-color: #f2f2f2;}

        #t2co_table tr:hover {background-color: #ddd;}

        #t2co_table th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #04AA6D;
            color: white;
        }
    </style>
    <script>
            function load() {
                val = "None" 
                src = ""

                formData = {
                    "category" : val,
                    "search" : src
                }
                $.ajax({
                        url : "/mq.php",
                        type : 'POST',
                        contentType : 'application/json',
                        data: JSON.stringify(formData),
                        success : function(responseStr) {
                            console.log(responseStr)
                            response = JSON.parse(responseStr)
                            console.log(response.status)
                            console.log(response["status"])
                            if (response["status"] == "success") {
                                for (j = 0; j < response['data'].length; j++) {
                                    l = response['data'][j]
                                    addAline(
                                        l
                                    )
                                }
                            } else {
                                
                                alert("Whoops")
                            }
                        },
                        error: function(xhr,status,error) {
                            console.log("An error occurred")
                        }
                    })
                let c = document.getElementById("container")
                while (c.childElementCount > 0) {
                    c.removeChild(c.firstElementChild)
                } 

            }

            function addAline(line) {
                const table = document.getElementById('t2co_table');
                const tableBody = table.getElementsByTagName('tbody')[0]; // If you have a tbody
                let newRow = document.createElement('tr');
                newRow.appendChild(keyCell(line['listingId'],line['listingName']))
                newRow.appendChild(newCell(line['listingDescription']))
                newRow.appendChild(newCell(line['categoryId']))
                newRow.appendChild(newCell(line['listingBanner']))
                newRow.appendChild(newCell(line['listingTime']))
                newRow.appendChild(newCell(line['listingAvailability']))
                newRow.appendChild(newCell(line['price']))
                tableBody.appendChild(newRow)
            }

            function keyCell(key,desc){
                cell = document.createElement("td");
                cell.innerHTML = `<a href="edit(${key})">${desc}</a>`;
                return cell
            }

            function newCell(content){
                cell = document.createElement("td");
                cell.textContent = desc;
                return cell
            }

    </script>
    <body onload="load();">
        <table id="t2co_table" class="interactive">
            <thead>
              <tr>
                <th>Name</th>
                <th>Description</th>
                <th>TokenId</th>
                <th>Category Id</th>
                <th>Banner</th>
                <th>Time</th>
                <th>Availability</th>
                <th>Price</th>
              </tr>
            </thead>
            <tbody>

            </tbody>
          </table>

    </body>
</html>