<!DOCTYPE html>
<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <title>dynaload</title>
        <style>
            .card-container {
                display: flex; /* Use flexbox for layout */
                flex-wrap: wrap; /* Allow cards to wrap to the next line */
                justify-content: center; /* Center cards horizontally */
                gap: 20px; /* Space between cards */
                padding: 20px;
            }

            .card {
                background-color: #fff;
                border-radius: 8px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                padding: 20px;
                width: 300px; /* Default width for cards */
                text-align: center;
            }

            .card h3 {
                margin-bottom: 10px;
                color: #333;
            }

            .card p {
                color: #666;
            }

            /* For screens smaller than 768px (e.g., tablets) */
            @media screen and (max-width: 768px) {
            .card {
                width: calc(50% - 20px); /* Two cards per row with gap */
            }
            }

            /* For screens smaller than 480px (e.g., mobile phones) */
            @media screen and (max-width: 480px) {
            .card {
                width: 100%; /* One card per row */
            }
            }
        </style>
        <script>
            function load() {
                val = document.getElementById("cat").value 
                src = document.getElementById("search").value.trim()

                formData = {
                    "category" : val,
                    "search" : src
                }
                $.ajax({
                        url : "/mq.php",
                        type : 'POST',
                        contentType : 'application/json',
                        data: JSON.stringify(formData),
                        success : function(responseStr) {
                            console.log(responseStr)
                            response = JSON.parse(responseStr)
                            console.log(response.status)
                            console.log(response["status"])
                            if (response["status"] == "success") {
                                for (j = 0; j < response['data'].length; j++) {
                                    l = response['data'][j]
                                    loadCard(
                                        l['listingName'],
                                        l['listingTime']
                                    )
                                }
                            } else {
                                
                                alert("Whoops")
                            }
                        },
                        error: function(xhr,status,error) {
                            console.log("An error occurred")
                        }
                    })
                let c = document.getElementById("container")
                while (c.childElementCount > 0) {
                    c.removeChild(c.firstElementChild)
                } 

            }

            function loadCard(title,sub) {
                let c = document.getElementById("container")
                let count = c.childElementCount + 1
                let dc = document.createElement("div")
                dc.classList.add("card")
                let hd = document.createElement("h3")
                let p = document.createElement("p")
                hd.innerHTML = title;
                p.innerHTML = sub;
                dc.appendChild(hd)
                dc.appendChild(p)
                c.appendChild(dc)
            }

            function addmore(){
                
                let c = document.getElementById("container")
                let count = c.childElementCount + 1
                let dc = document.createElement("div")
                dc.classList.add("card")
                let hd = document.createElement("h3")
                let p = document.createElement("p")
                hd.innerHTML = `Card Title ${count}`;
                p.innerHTML = `this is the content of card ${count}`;
                dc.appendChild(hd)
                dc.appendChild(p)
                c.appendChild(dc)
            }

            function init() {
                console.log("init dropdown (should be from DB)")
                c = document.getElementById("cat")
                for (j = 1; j < 10; j++) {
                    opt = document.createElement("option")
                    opt.value = j
                    opt.innerHTML = `Category ${j}`
                    c.appendChild(opt)
                }
            }
        </script>
    </head>
    <body onload="init()">
        <label for="cat">Choose a category:</label>

       
        <div> 
            <select name="cat" id="cat" onchange="load();">
                <option value="None">None</option>
               
            </select>
            <label for="search">Search</label>
            <input class="form-styling" type="text" id="search" />
            <button onclick="load()">Load!</button>
        </div>
        <div class="card-container" id="container">
            <div class="card">
              <h3>Card Title 1</h3>
              <p>This is the content of card 1.</p>
            </div>
            <div class="card">
              <h3>Card Title 2</h3>
              <p>This is the content of card 2.</p>
            </div>
            <div class="card">
              <h3>Card Title 3</h3>
              <p>This is the content of card 3.</p>
            </div>
        </div>
        <div>
            <button onclick="addmore()">Add More!</button>
        </div>
    </body>
</html>



